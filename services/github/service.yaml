name: github
version: "1.0"
description: GitHub REST API fake
docs: https://docs.github.com/en/rest

brief: |
  GitHub is a developer platform for version control and collaboration.
  Its REST API allows programmatic access to repositories, issues,
  pull requests, users, organizations, and more.

  This fake implements the core GitHub REST API surface that AI agents
  typically interact with: repository management, issue and pull request
  workflows, and webhook event delivery.

supported_flows:
  - crud-repos
  - crud-issues
  - crud-pull-requests
  - webhooks

server:
  command: ["uv", "run", "python", "main.py"]

contracts:
  command: ["uv", "run", "pytest", "-v", "--tb=short"]

# Environment variables set by the CLI when running contract tests:
#   DOUBLEAGENT_GITHUB_URL - URL of the running fake service (set automatically)
#   PORT - Port the service listens on (set automatically)

features:
  webhooks: true

# Optional snapshot pull connector configuration.
# This enables: doubleagent snapshot pull github
connector:
  type: airbyte
  image: airbyte/source-github:latest
  streams:
    - repositories
    - issues
    - pull_requests
  config_env:
    GITHUB_ACCESS_TOKEN: credentials.personal_access_token
    GITHUB_REPOSITORY: repository
  stream_mapping:
    repositories: repos
    issues: issues
    pull_requests: pulls
  required_env:
    - GITHUB_ACCESS_TOKEN
    - GITHUB_REPOSITORY
  backend: pyairbyte
